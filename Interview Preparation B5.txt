# --- NEW FUNCTION TO EXTRACT DBS DETAILS (Corrected) ---
def extract_dbs_details_from_page():
    mf.move_to(22, 45)
    mf.send_string("z")
    mf.send_enter()
    try:
        mf.wait_for_text("HISTORY ITEM DETAILS", timeout=5)
    except Exception as e:
        print(f"    -> WARNING: Did not find 'HISTORY ITEM DETAILS' screen. {e}")
        mf.send_pf2()
        mf.wait_for_field()
        return None

    screen_text = mf.get_screen_text()
    dbs_count = 0
    dbs_match = re.search(r"^\s*OTHER AUTOMATED DBS\s+[\d.]+\s+(\d+)", screen_text, re.MULTILINE)
    
    if dbs_match:
        # The count is in the first (and only) captured group.
        dbs_count = int(dbs_match.group(1))
        print(f"    -> Found OTHER AUTOMATED DBS with count: {dbs_count}")
    else:
        print("    -> 'OTHER AUTOMATED DBS' not found on this page.")

    mf.send_pf2()
    mf.wait_for_field()
    return dbs_count
