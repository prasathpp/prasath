' modMain module

Option Explicit ' Forces variable declaration

'****************************************************************************************************
' Main Automation Procedure to Open Browser
'****************************************************************************************************

' This is the procedure you will run from Excel (e.g., by pressing Alt+F8 and selecting it).
Sub OpenEdgeProcessPortal()

    ' --- Configuration ---
    ' Process name for Microsoft Edge
    Const EDGE_PROCESS_NAME As String = "msedge.exe"
    ' The specific URL to open
    Const PORTAL_URL As String = "https://fsso.fm.rbsgrp.net/idp/startsso.ping?PartnerSpId=NATWEST_PF_External_EMEA_Prod"
    ' ---------------------

    Dim wasOpened As Boolean

    ' Call the OpenBrowser function located in modAutomationHelpers
    ' Since OpenBrowser is declared Public, it's accessible from any module.
    wasOpened = OpenBrowser(EDGE_PROCESS_NAME, PORTAL_URL)

    ' Check the result and provide feedback
    If wasOpened Then
        MsgBox "Edge browser opened successfully and navigated to the specified link.", vbInformation
    Else
        MsgBox "Failed to open Edge browser or navigate. Check if " & EDGE_PROCESS_NAME & " exists in the expected location (Registry) or if there was an error during execution.", vbCritical
    End If

End Sub

' You can add other main automation procedures here that use the helper functions
' from modAutomationHelpers.
