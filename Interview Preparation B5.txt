Public Function OpenBrowser(ByVal processName As String, ByVal url As String) As Boolean
    ' Opens a new browser window (Edge or Chrome) at a specified URL.
    ' Uses ShellExecute API and a hardcoded process path.

    Dim processPath As String
    Dim commandLine As String
    Dim shellResult As Long

    OpenBrowser = False ' Initialize return value

    On Error GoTo ErrorHandler

    ' --- HARDCODED PATH ---
    ' The registry lookup failed on some machines, so we are providing the direct path.
    ' PASTE THE PATH YOU COPIED FROM THE EDGE SHORTCUT PROPERTIES HERE.
    processPath = "C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe"
    ' --------------------
    
    If processPath <> "" Then
        ' NOTE: When using ShellExecute with a file path that has spaces,
        ' it's often better to put the path in the "lpFile" argument
        ' and the URL in the "lpParameters" argument. But combining them can also work.
        ' Let's stick to the combined method for now.
        commandLine = """" & processPath & """" & " /new-window " & url
        
        ' Using ShellExecute's lpFile parameter directly
        shellResult = ShellExecute(0, "open", processPath, "/new-window " & url, "", 1)

        If shellResult > 32 Then
            Application.Wait VBA.DateAdd("s", 1, Now)
            OpenBrowser = True
        Else
            Debug.Print "ShellExecute failed with error code: " & shellResult & ". Could not open browser: " & processName
            MsgBox "Failed to open browser using the hardcoded path. Check the path in the OpenBrowser function.", vbCritical
        End If
    Else
        ' This part is now unlikely to be reached, but is kept for safety.
        Debug.Print "The hardcoded browser path is empty."
        MsgBox "The hardcoded browser path is empty.", vbCritical
    End If

ExitProcedure:
    Exit Function

ErrorHandler:
    OpenBrowser = False
    Debug.Print "Error in OpenBrowser: " & Err.Description & " (Error " & Err.Number & ")"
    Resume ExitProcedure
End Function
