Option Explicit

Sub GoToTermAll()

    ' Attachmate Reflection objects
    Dim app As Attachmate_Reflection_Objects_Framework.ApplicationObject
    Dim frame As Attachmate_Reflection_Objects.Frame
    Dim view As Attachmate_Reflection_Objects.View
    Dim session As Attachmate_Reflection_Objects.Session
    Dim term As Attachmate_Reflection_Objects_Emulation_IbmHosts.IbmTerminal
    Dim screen As Attachmate_Reflection_Objects_Emulation_IbmHosts.IbmScreen

    Dim frameCount As Integer
    Dim i As Integer

    ' Attach to Reflection Workspace
    Set app = GetObject(, "ReflectionWorkspace.Application")
    
    frameCount = app.GetFrameCount

    For i = 1 To frameCount
        Set frame = app.GetFrame(i)

        If frame.Caption = "NTS Back Office - Prod.rd3x" Then
            Set view = frame.View
            Set session = view.Session
            Set term = session
            Set screen = term.Screen

            ' Go to Application Selection Menu (Page Down key)
            screen.SendControlKey ControlKey_PageDown
            screen.WaitForHostSettle 500, 1000

            ' Enter "TERM ALL" at position 21,13 and press Enter
            screen.PutText2 "TERM ALL", 21, 13
            screen.SendControlKey ControlKey_Enter

            Exit For
        End If
    Next i

End Sub
